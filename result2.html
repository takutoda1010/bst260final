<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Takuto Yoshida" />

<meta name="date" content="2022-12-14" />

<title>result2</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Predictions of Titanic Survivors</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Index.html">Home</a>
</li>
<li>
  <a href="intro.html">
    <span class="fa fa-user"></span>
     
    Introduction
  </a>
</li>
<li>
  <a href="result.html">
    <span class="fa fa-file-pdf-o"></span>
     
    Result1
  </a>
</li>
<li>
  <a href="result2.html">
    <span class="fa fa-file-pdf-o"></span>
     
    Result2
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">result2</h1>
<h4 class="author">Takuto Yoshida</h4>
<h4 class="date">2022-12-14</h4>

</div>


<div id="feature-engineering-missing-value-imputation"
class="section level1">
<h1><strong>3. Feature Engineering $ Missing Value
Imputation</strong></h1>
<div id="feature-engineering" class="section level2">
<h2><strong>3.1 Feature Engineering</strong></h2>
<div id="title" class="section level3">
<h3><strong>3.1.1 Title</strong></h3>
<p>From the evaluation of the variables so far, I have found that
survival rates are higher for economically well-off individuals and for
women. Thus, it is possible that survival rates can be predicted from
name titles. I subtracted the Title from <em>Name</em> by using regular
expression.</p>
<pre><code>##               
##                  0   1
##   Capt           1   0
##   Col            1   1
##   Don            1   0
##   Dona           0   0
##   Dr             4   3
##   Jonkheer       1   0
##   Lady           0   1
##   Major          1   1
##   Master        17  23
##   Miss          55 127
##   Mlle           0   2
##   Mme            0   1
##   Mr           436  81
##   Mrs           26  99
##   Ms             0   1
##   Rev            6   0
##   Sir            0   1
##   the Countess   0   1</code></pre>
<pre><code>##         
##          Capt Col Don Dona  Dr Jonkheer Lady Major Master Miss Mlle Mme  Mr Mrs
##   female    0   0   0    1   1        0    1     0      0  260    2   1   0 197
##   male      1   4   1    0   7        1    0     2     61    0    0   0 757   0
##         
##           Ms Rev Sir the Countess
##   female   2   0   0            1
##   male     0   8   1            0</code></pre>
<pre><code>##               
##                        0         1
##   Capt         1.0000000 0.0000000
##   Col          0.5000000 0.5000000
##   Don          1.0000000 0.0000000
##   Dona                            
##   Dr           0.5714286 0.4285714
##   Jonkheer     1.0000000 0.0000000
##   Lady         0.0000000 1.0000000
##   Major        0.5000000 0.5000000
##   Master       0.4250000 0.5750000
##   Miss         0.3021978 0.6978022
##   Mlle         0.0000000 1.0000000
##   Mme          0.0000000 1.0000000
##   Mr           0.8433269 0.1566731
##   Mrs          0.2080000 0.7920000
##   Ms           0.0000000 1.0000000
##   Rev          1.0000000 0.0000000
##   Sir          0.0000000 1.0000000
##   the Countess 0.0000000 1.0000000</code></pre>
<p><img src="result2_files/figure-html/unnamed-chunk-4-1.png" width="672" />
There are several few titles. We have summarized and categorized them
into groups of six titles.</p>
<p><img src="result2_files/figure-html/unnamed-chunk-6-1.png" width="672" />
It can be seen that the mortality rate is very high for those with the
title “Mr.”.</p>
</div>
<div id="cabin-data" class="section level3">
<h3><strong>3.1.2 Cabin data</strong></h3>
<p>Many part of cabin data was missing. Since assigning missing values
would place a very strong presumption, I made it a binary variable with
and without data.</p>
<pre><code>## 
##         0         1 
## 0.7746371 0.2253629</code></pre>
</div>
<div id="fare-per-person" class="section level3">
<h3><strong>3.1.3 Fare (per person)</strong></h3>
<p>We created the per capita fare cost as a variable because it is
possible that more affluent people purchase more expensive tickets and
have higher survival rates.</p>
<p><img src="result2_files/figure-html/unnamed-chunk-10-1.png" width="672" />
There are correlation between Group size and Pclass. ###
<strong>3.1.4</strong> Based on previous studies, it is possible that
the larger the family size, the higher the survival rate. Thus, I
created a family size variable.</p>
</div>
</div>
<div id="missing-value" class="section level2">
<h2><strong>3.2 Missing Value</strong></h2>
<p>From here, I have addressed the variables with missing values. I know
that there were missing values in <strong>Age</strong>, and
<strong>Fare_pp_FE</strong>. I also know that <strong>Embarked</strong>
has a blank entry.</p>
<pre><code>##                    var missing missing_prop
## 1             Survived     418 0.3193277311
## 2                  Age     263 0.2009167303
## 3           Fare_pp_FE       1 0.0007639419
## 4          PassengerId       0 0.0000000000
## 5               Pclass       0 0.0000000000
## 6                  Sex       0 0.0000000000
## 7                SibSp       0 0.0000000000
## 8                Parch       0 0.0000000000
## 9             Embarked       0 0.0000000000
## 10           Test_Data       0 0.0000000000
## 11               Title       0 0.0000000000
## 12             Surname       0 0.0000000000
## 13           Cabin_dat       0 0.0000000000
## 14      Family_size_FE       0 0.0000000000
## 15 Total_group_size_FE       0 0.0000000000</code></pre>
<div id="fare" class="section level3">
<h3><strong>3.2.1 Fare</strong></h3>
<pre><code>##     PassengerId Pclass  Sex  Age SibSp Parch Embarked Test_Data Survived Title
## 153        1044      3 male 60.5     0     0        S         0       NA    Mr
##     Surname Cabin_dat Fare_pp_FE Family_size_FE Total_group_size_FE
## 153  Storey         0         NA              1                   1</code></pre>
<p>There was only one missing value. Since there was one missing value,
the median value was assigned instead of taking a special imputation
method to save time.</p>
</div>
<div id="embarked" class="section level3">
<h3><strong>3.2.2 Embarked</strong></h3>
<p>I can see that there are two missing calues in the
<strong>Embarked</strong>. Most passengers are classified as “S”.
However, they are classified as “C” because their ticket price is high
and it is possible that the wealthier passengers are from “C”.</p>
<pre><code>## [1]  480 1248</code></pre>
<pre><code>##      PassengerId Pclass    Sex Age SibSp Parch Embarked Test_Data Survived
## 480           62      1 female  38     0     0                  1        1
## 1248         830      1 female  62     0     0                  1        1
##      Title Surname Cabin_dat Fare_pp_FE Family_size_FE Total_group_size_FE
## 480   Miss   Icard         1         40              1                   2
## 1248   Mrs   Stone         1         40              1                   2</code></pre>
<pre><code>## 
##   C   Q   S 
## 272 123 914</code></pre>
</div>
<div id="age" class="section level3">
<h3><strong>3.2.3 Age</strong></h3>
<p>The missing calues for <strong>Age</strong> have been found to be
about 20% of the total. Therefore, it is reasonable to use the
imputation method to deal with missing values. Here, the missing values
were assigned by random forest.</p>
<pre><code>## Rows: 1,309
## Columns: 15
## $ PassengerId         &lt;int&gt; 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, …
## $ Pclass              &lt;ord&gt; Third, Third, Second, Third, Third, Third, Third, …
## $ Sex                 &lt;fct&gt; male, female, male, male, female, male, female, ma…
## $ Age                 &lt;dbl&gt; 34.5, 47.0, 62.0, 27.0, 22.0, 14.0, 30.0, 26.0, 18…
## $ SibSp               &lt;int&gt; 0, 1, 0, 0, 1, 0, 0, 1, 0, 2, 0, 0, 1, 1, 1, 1, 0,…
## $ Parch               &lt;int&gt; 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Embarked            &lt;fct&gt; Q, S, Q, S, S, S, Q, S, C, S, S, S, S, S, S, C, Q,…
## $ Test_Data           &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Survived            &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ Title               &lt;fct&gt; Mr, Mrs, Mr, Mr, Mrs, Mr, Miss, Mr, Mrs, Mr, Mr, M…
## $ Surname             &lt;chr&gt; &quot;Kelly&quot;, &quot;Wilkes&quot;, &quot;Myles&quot;, &quot;Wirz&quot;, &quot;Hirvonen&quot;, &quot;S…
## $ Cabin_dat           &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0,…
## $ Fare_pp_FE          &lt;dbl&gt; 7.83, 7.00, 9.69, 8.66, 6.14, 9.22, 7.63, 9.67, 7.…
## $ Family_size_FE      &lt;dbl&gt; 1, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 1, 2, 2, 2, 2, 1,…
## $ Total_group_size_FE &lt;int&gt; 1, 2, 1, 1, 3, 1, 1, 3, 1, 3, 1, 1, 2, 2, 2, 2, 1,…</code></pre>
<p>I used 5-fold cross validation with different mtry values.</p>
<pre><code>## Random Forest 
## 
## 1046 samples
##    9 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (5 fold, repeated 5 times) 
## Summary of sample sizes: 837, 837, 837, 836, 837, 837, ... 
## Resampling results across tuning parameters:
## 
##   mtry  RMSE      Rsquared   MAE     
##   2     10.51618  0.4684004  8.093269
##   3     10.57352  0.4610362  8.081742
##   4     10.66986  0.4531266  8.133477
## 
## RMSE was used to select the optimal model using the smallest value.
## The final value used for the model was mtry = 2.</code></pre>
<p>We can see that the RMSE is the smallest value when mtry = 2.Thus, we
see that we are predicting with a random forest of mtry=2.　Looking at
the impact on variable predictions, it is clear that the
<strong>Title</strong> has a significant impact.</p>
<pre><code>## rf variable importance
## 
##                     Overall
## Title               100.000
## Fare_pp_FE           63.544
## Parch                53.242
## Pclass               39.914
## Total_group_size_FE  35.331
## SibSp                26.641
## Sex                   6.987
## Cabin_dat             2.805
## Embarked              0.000</code></pre>
<p>Using this prediction formula, the missing value of
<strong>Age</strong> is sbstituted. For those with missing age, we put
the predicted value, and for those without missing age, we set the
original value.’ Master’ and older than 13 years old were set to 13
years old.</p>
</div>
<div id="child" class="section level3">
<h3>3.2.4. Child</h3>
<p>Since it is presumed that younger people have a higher survival rate,
a variable was set up to define children as those under 15 years of
age.</p>
</div>
</div>
</div>
<div id="building-and-tuning-the-final-model" class="section level1">
<h1>** Building and Tuning the Final Model</h1>
<p>I have divided the full model again into test and training data. The
training data is used to create a predictive model to predict the
survival of the test data.</p>
<div id="model-2-removing-the-least-useful-variables"
class="section level2">
<h2><strong>Model 2: Removing the least useful variables:</strong></h2>
<p>Next, I created a prediction model without <strong>Cabin_dat</strong>
and <strong>IsChild_FE</strong>, which were considered not very useful
for prediction in the previous analysis. I have created a predictive
model with a random forest as well. We found that Accuracy was highest
at mtry=2.</p>
<pre><code>## Random Forest 
## 
## 891 samples
##   7 predictor
##   2 classes: &#39;0&#39;, &#39;1&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (5 fold, repeated 5 times) 
## Summary of sample sizes: 713, 712, 713, 713, 713, 713, ... 
## Resampling results across tuning parameters:
## 
##   mtry  Accuracy   Kappa    
##   2     0.8332112  0.6372489
##   3     0.8287356  0.6301512
##   4     0.8157295  0.6043597
##   5     0.8090005  0.5916637
##   6     0.8098981  0.5937709
##   7     0.8056284  0.5852647
## 
## Accuracy was used to select the optimal model using the largest value.
## The final value used for the model was mtry = 2.</code></pre>
<pre><code>## rf variable importance
## 
##                     Importance
## Title                   100.00
## Sex                      97.40
## Fare_pp_FE               88.22
## Total_group_size_FE      82.45
## Pclass                   79.88
## Age_IMP                  58.96
## Embarked                  0.00</code></pre>
<pre><code>## [1] &quot;The maximum accuracy was 0.83321&quot;</code></pre>
<p>The results show that model2 has slightly higher Accuracy. I
determined this to be the final model.</p>
</div>
<div id="conclusion" class="section level2">
<h2><strong>Conclusion</strong></h2>
<p>I was able to obtain high Accuracy with the Random Forest model using
<strong>Title</strong>, <strong>Sex</strong>,
__Fare__pp<strong>FE</strong>, <strong>Total_group_size_FE</strong>,
<strong>Pclass</strong>, <strong>Age_IMP</strong>,
<strong>Embarked</strong>. If I have time in the future, I would like to
create a support vector machine and XGboost model, which I plan to study
in the spring semester or later.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
